<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gift Fortune</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #34495e;
            --accent: #3498db;
            --text: #ecf0f1;
        }

        body {
            margin: 0;
            padding: 0;
            background: var(--primary);
            color: var(--text);
            font-family: 'Arial', sans-serif;
            min-height: 100vh;
        }

        .header {
            padding: 15px;
            background: var(--secondary);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .profile-photo {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
        }

        .page {
            display: none;
            padding: 20px;
            min-height: calc(100vh - 150px);
        }

        .page.active {
            display: block;
        }

        .wheel-container {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 20px auto;
        }

        .wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 4px solid var(--accent);
            position: relative;
            overflow: hidden;
            transition: transform 3s cubic-bezier(0.25, 0.1, 0.25, 1);
            background: conic-gradient(
                #e74c3c, #2ecc71, #f1c40f, #9b59b6,
                #e74c3c, #2ecc71, #f1c40f, #9b59b6
            );
        }

        .spin-btn {
            display: block;
            margin: 30px auto;
            padding: 15px 40px;
            background: var(--accent);
            border: none;
            border-radius: 25px;
            color: white;
            font-size: 1.2em;
            cursor: pointer;
        }

        .nav-bar {
            position: fixed;
            bottom: 0;
            width: 100%;
            background: var(--secondary);
            padding: 10px;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 5px;
        }

        .nav-btn {
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: var(--primary);
            color: var(--text);
            cursor: pointer;
        }

        .nav-btn.active {
            background: var(--accent);
        }

        .gift-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 20px;
        }

        .gift-item {
            padding: 10px;
            background: var(--secondary);
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="header">
        <img class="profile-photo" id="userPhoto" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCI+PHJlY3Qgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiIGZpbGw9IiMzNDk4ZGIiLz48dGV4dCB4PSI1MCUiIHk9IjUwJSIgZm9udC1zaXplPSIzMCIgZmlsbD0iI2VjZjBmMSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkFyaWFsIj5HPC90ZXh0Pjwvc3ZnPg==">
        <div>
            <h2 id="userName">–ì–æ—Å—Ç—å</h2>
            <p id="userStatus">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</p>
        </div>
    </div>

    <div id="page1" class="page active">
        <div class="wheel-container">
            <div class="wheel" id="wheel"></div>
        </div>
        <button class="spin-btn" id="spinBtn">üé° –ö—Ä—É—Ç–∏—Ç—å!</button>
    </div>

    <div id="page2" class="page">
        <h2>–ú–æ–∏ –ø–æ–¥–∞—Ä–∫–∏</h2>
        <div class="gift-list" id="giftList"></div>
        <button class="nav-btn" id="addGiftBtn" style="margin-top: 20px;">+ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–∞—Ä–æ–∫</button>
    </div>

    <div id="page3" class="page">
        <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
        <div class="stats">
            <p>–ü–æ–±–µ–¥: <span id="wins">0</span></p>
            <p>–ü–æ—Ä–∞–∂–µ–Ω–∏–π: <span id="losses">0</span></p>
        </div>
    </div>

    <div id="page4" class="page">
        <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
        <div class="settings">
            <input type="text" id="userNameInput" placeholder="–í–∞—à–µ –∏–º—è">
            <button class="nav-btn" id="saveNameBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>

    <nav class="nav-bar">
        <button class="nav-btn active" data-page="1">üé∞ –ò–≥—Ä–∞—Ç—å</button>
        <button class="nav-btn" data-page="2">üéÅ –ü–æ–¥–∞—Ä–∫–∏</button>
        <button class="nav-btn" data-page="3">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
        <button class="nav-btn" data-page="4">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
    </nav>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
        let user = {
            name: '–ì–æ—Å—Ç—å',
            photo: '',
            gifts: [],
            stats: { wins: 0, losses: 0 }
        };

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ Telegram Web App
        const isTelegram = typeof Telegram !== 'undefined' && Telegram.WebApp;

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è
        function loadProfile() {
            if(isTelegram) {
                const tgUser = Telegram.WebApp.initDataUnsafe.user;
                if(tgUser) {
                    user.name = [tgUser.first_name, tgUser.last_name].filter(Boolean).join(' ');
                    user.photo = tgUser.photo_url || user.photo;
                }
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ localStorage
            const savedData = localStorage.getItem('userData');
            if(savedData) {
                const data = JSON.parse(savedData);
                user = { ...user, ...data };
            }

            updateProfile();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateProfile() {
            document.getElementById('userName').textContent = user.name;
            document.getElementById('userPhoto').src = user.photo || document.getElementById('userPhoto').src;
            document.getElementById('wins').textContent = user.stats.wins;
            document.getElementById('losses').textContent = user.stats.losses;
            document.getElementById('giftList').innerHTML = user.gifts
                .map((gift, i) => `<div class="gift-item">–ü–æ–¥–∞—Ä–æ–∫ ${i + 1}</div>`)
                .join('');
        }

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.nav-btn, .page').forEach(el => {
                    el.classList.remove('active');
                });
                const pageId = this.dataset.page;
                document.getElementById(`page${pageId}`).classList.add('active');
                this.classList.add('active');
            });
        });

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∞—Ä–∫–∞
        document.getElementById('addGiftBtn').addEventListener('click', () => {
            user.gifts.push(`–ü–æ–¥–∞—Ä–æ–∫ ${user.gifts.length + 1}`);
            localStorage.setItem('userData', JSON.stringify(user));
            updateProfile();
        });

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏
        document.getElementById('saveNameBtn').addEventListener('click', () => {
            user.name = document.getElementById('userNameInput').value || '–ì–æ—Å—Ç—å';
            localStorage.setItem('userData', JSON.stringify(user));
            updateProfile();
        });

        // –ö–æ–ª–µ—Å–æ —Ñ–æ—Ä—Ç—É–Ω—ã
        let isSpinning = false;
        document.getElementById('spinBtn').addEventListener('click', () => {
            if(!isSpinning) {
                isSpinning = true;
                const rotations = 5 + Math.random() * 2;
                const wheel = document.getElementById('wheel');
                
                wheel.style.transform = `rotate(${rotations * 360}deg)`;
                
                setTimeout(() => {
                    isSpinning = false;
                    user.stats.wins++;
                    localStorage.setItem('userData', JSON.stringify(user));
                    updateProfile();
                    alert('–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Å –≤—ã–∏–≥—Ä—ã—à–µ–º!');
                }, 3000);
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        loadProfile();

        // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –Ω–µ-Telegram —Å—Ä–µ–¥—ã
        if(!isTelegram) {
            document.getElementById('userStatus').textContent = '–ì–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º';
            if(typeof Telegram !== 'undefined') {
                Telegram.WebApp.ready();
                Telegram.WebApp.expand();
            }
        }
    </script>
</body>
</html>
